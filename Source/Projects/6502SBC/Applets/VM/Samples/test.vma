; Simple CALL/RET test - main calls a helper function
.CONST
    Print.String 0x11
    Print.Char   0x12
    ZP.STR       0x1E
    
.DATA
    STR0 "Before call\n"
    STR1 "In helper\n"  
    STR2 "After return\n"
    
.FUNC Helper
    ; Print "In helper"
    PUSHD STR1           ; Push string 1
    POPZW ZP.STR
    SYSCALL Print.String
    
    ; Print a character
    PUSHB 'X'
    POPA
    SYSCALL Print.Char
    
    PUSHB 10             ; Newline
    POPA
    SYSCALL Print.Char
    
    RET                  ; Return to main

.MAIN
    ; Print "Before call"
    PUSHD STR0           ; Push string 0
    POPZW ZP.STR         ; Marshal to BIOS
    SYSCALL Print.String
    
    ; Call helper function (ID 1)
    CALL Helper          ; Call Helper
    
    ; Print "After return"
    PUSHD STR2           ; Push string 2
    POPZW ZP.STR
    SYSCALL Print.String
    
    HALT

